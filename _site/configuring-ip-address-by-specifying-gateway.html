<!DOCTYPE html>
<!--[if lte IE 8]><html class="ie lte8"><![endif]-->
<!--[if IE]><html class="ie"><![endif]-->
<!--[if !IE]><!--><html><!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>配置特定 IP 地址走指定网关 | 殷东亮的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.3, user-scalable=no" />
    <meta name="description" content="公司有两个日常上网用的路由器，分别接不同的两条网线，虽然都是电信的，但是一条偶尔会抽风，我的 VPS 会连不上，也就是挂在上面的 SS 无法使用。恰好这根线是公司接台式机的，也就是说平时上班偶尔会无法科学上网。" />
    <meta name="keywords" content="路由, 网卡, 网关, 路由表" />
    <meta name="author" content="fooleap" />
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="canonical" href="http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway" />
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />
    <link rel="icon" href="/favicon.png" />
    <link rel="alternate" type="application/atom+xml" title="殷东亮的博客 Atom Feed" href="http://blog.fooleap.org/atom.xml" />
    <script type="text/javascript" src="/assets/js/modernizr.js"></script>
    <!--[if lte IE 9]>
      <script src="/assets/js/html5shiv.min.js"></script>
      <script src="/assets/js/respond.min.js"></script>
      <script src="/assets/js/classList.min.js"></script>
      <script type="text/javascript">
        document.createElement('main');
      </script>
    <![endif]-->
  </head>
  <body>
  <nav id="navigation">
      <ul class="navigation-list hide">
          <li><a href="/" class="navigation-item"><i class="icon-home"></i>首页</a></li>
          <li><a href="/archive.html" class="navigation-item"><i class="icon-box"></i>归档</a></li>
          <li><a href="/about.html" class="navigation-item"><i class="icon-user"></i>关于</a></li>
      </ul>
      <i id="menu" class="icon icon-menu"></i>
  </nav>
  
  <div class="container">
    <main class="wrapper">
      <header class="site-header">
        <h1>
          配置特定 IP 地址走指定网关
        </h1>
        <h2 class="sub-heading">
            <i class="icon-calendar"></i><time datetime="2016-08-13">2016 年 08 月 13 日</time>
        </h2>
      </header>
  <article class="post-content">
    
  <div class="main-content">
<p>公司有两个日常上网用的路由器，分别接不同的两条网线，虽然都是电信的，但是一条偶尔会抽风，我的 VPS 会连不上，也就是挂在上面的 SS 无法使用。恰好这根线是公司接台式机的，也就是说平时上班偶尔会无法科学上网。</p>

<p>这对我来说几乎是无法忍的，面对不能科学上网的网络环境不免痒痒，干脆搞个 USB 无线网卡，当抽风的时候，就使用无线网卡连接公司另一个路由器得了。刚好我有一个，每天都放包里，偶尔拿出来用用也挺方便的。</p>

<p>可是工作有时候需要访问内部网络，例如共享文件夹、VSS 等。总不能每一次都手动切换使用网卡吧。于是我就想，访问内部网络的时候通过有线网卡，平时上网使用无线网卡。这就需要修改路由表了。</p>

<p>亏我还是网络技术专业，学没好好上，连最基本的修改路由都不会，于是请教了一下 <a href="https://blackeeper.com/">Blackeeper</a>，经指点，这也是挺简单的操作。</p>

<p>查看路由表</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; route print -4

 IPv4 路由表
===========================================================================
活动路由:
网络目标        网络掩码      网关           接口            跃点数
0.0.0.0         0.0.0.0       10.0.0.1       10.0.0.19       276
0.0.0.0         0.0.0.0       192.168.1.2    192.168.1.102   25
</code></pre>
</div>

<p>由上表，可以看到两根网线分别对应两个内网 IP、两个网关，有线网卡网关是 <code class="highlighter-rouge">10.0.0.1</code>，无线网卡网关是 <code class="highlighter-rouge">192.168.1.2</code>。目前是无线网卡优先级比较高，也就是说上网是通过无线网卡的。</p>

<p>首先，将默认网关改成无线网卡的，并设置 <code class="highlighter-rouge">metric</code> 值为 <code class="highlighter-rouge">15</code>，我也不大清楚这是什么意思，只知道值越小优先级越高。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; route change 0.0.0.0 mask 0.0.0.0 192.168.1.2 metric 15

操作完成!
</code></pre>
</div>

<p>然后，添加一条路由，访问 <code class="highlighter-rouge">10.0.0.20</code> 通过网关 <code class="highlighter-rouge">10.0.0.1</code>，<code class="highlighter-rouge">metric</code> 值设置比上面的低一点。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; route add 10.0.0.20 mask 255.255.255.255 10.0.0.1 metric 3

操作完成!
</code></pre>
</div>

<p>操作完成之后，再看路由表，就有变化了，跃点数并不是 <code class="highlighter-rouge">metric</code>，按实际是越小优先级越高。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt; route print -4

 IPv4 路由表
===========================================================================
活动路由:
网络目标        网络掩码          网关         接口           跃点数
0.0.0.0         0.0.0.0           192.168.1.2  192.168.1.102  40
10.0.0.20       255.255.255.255   10.0.0.1     10.0.0.19      23
</code></pre>
</div>

<p>写到这里，好像第一步是没有必要的，只要设置指定 IP 通过 <code class="highlighter-rouge">10.0.0.1</code> 访问即可，优先级高点。如果访问另一个 IP，也需要走那个网关，添加上去就是。</p>

<p><strong>本文历史</strong></p>

<ul>
  <li>2016 年 08 月 14 日 完成初稿</li>
</ul>

  </div>

  <div id="posts">
    <div id="random-posts" class="posts">
      <strong>猜你喜欢</strong>
      <ul>
      </ul>
    </div>
  
    <div id="recent-posts" class="posts">
      <strong>最近更新</strong>
      <ul>
      
        <li><a href="/configuring-ip-address-by-specifying-gateway" title="配置特定 IP 地址走指定网关">配置特定 IP 地址走指定网关 </a></li>
      
        <li><a href="/add-google-satellite-layer-in-amap" title="高德地图 API 叠加谷歌地图图层">高德地图 API 叠加谷歌地图图层 </a></li>
      
        <li><a href="/from-codoon-to-nikeplus" title="将咕咚的数据导入到 Nike+">将咕咚的数据导入到 Nike+ </a></li>
      
        <li><a href="/the-influence-of-sports-apps" title="运动 APP 的作用">运动 APP 的作用 </a></li>
      
        <li><a href="/the-last-run-of-june" title="今年 6 月的最后一次跑步">今年 6 月的最后一次跑步 </a></li>
      
      </ul>
    </div>
  </div>

  <div id="info" class="tech">

    <span id="share">
  <div id="qrcode"></div>
  <a id="wechat" title="分享到微信" data-wechat-url="http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway" href="javascript:void(0);"><i class="icon-wechat"></i></a>
  <a id="weibo" target="_blank" title="分享到微博" href="http://service.weibo.com/share/share.php?title=配置特定 IP 地址走指定网关 | 殷东亮的博客 via @&amp;url=http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway&amp;type=3&amp;searchPic=1"><i class="icon-weibo"></i></a>
  <a id="qzone" target="_blank" title="分享到 QQ 空间" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway&amp;title=配置特定 IP 地址走指定网关 | 殷东亮的博客&amp;summary=公司有两个日常上网用的路由器，分别接不同的两条网线，虽然都是电信的，但是一条偶尔会抽风，我的 VPS 会连不上，也就是挂在上面的 SS 无法使用。恰好这根线是公司接台式机的，也就是说平时上班偶尔会无法科学上网。&amp;site=http://127.0.0.1:4000"><i class="icon-qzone"></i></a>
  <a id="twitter" target="_blank" title="Share to Twitter" href="https://twitter.com/intent/tweet?url=http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway&amp;text=配置特定 IP 地址走指定网关｜殷东亮的博客&amp;via="><i class="icon-twitter"></i></a>
  <a id="facebook" target="_blank" title="Share to Facebook" href="http://www.facebook.com/sharer.php?u=http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway&amp;t=配置特定 IP 地址走指定网关 | 殷东亮的博客"><i class="icon-facebook-official"></i></a>
  <a id="gplus" target="_blank" title="Share to Google+" href="https://plus.google.com/share?url=http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway"><i class="icon-gplus-squared"></i></a>
</span>


    <span class='like'><a href="javascript:void(0)" title=""><i class="icon-heart-empty"></i> <span class="disqus-like-count"></span></a></span>
    <span class='view-code'><a href="javascript:void(0)" data-md="https://raw.githubusercontent.com/fooleap/fooleap.github.io/master/_posts/2016-08-13-configuring-ip-address-by-specifying-gateway.md" title="在正文中查看源码"><i class="icon-file-code"></i>源码</a></span>
    <span class="number-of-word"><i class="icon-calc"></i>1429 字</span>
    <span class="page-tags"><i class="icon-tags"></i><ul class="tags"> <li class="tag"><a href="/tags.html#路由" target="_blank" title="查看“路由”的相关文章">路由</a></li><li class="tag"><a href="/tags.html#网卡" target="_blank" title="查看“网卡”的相关文章">网卡</a></li><li class="tag"><a href="/tags.html#网关" target="_blank" title="查看“网关”的相关文章">网关</a></li><li class="tag"><a href="/tags.html#路由表" target="_blank" title="查看“路由表”的相关文章">路由表</a></li></ul></span>
  </div>

</article>

<div class="comment" id="disqus_thread">
    <a class="show-comments" href="http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway#disqus_thread" data-disqus-identifier="/configuring-ip-address-by-specifying-gateway"><span class="has-comment"><i class="icon-chat-empty"></i> 留下</span>评论 <span class="disqus-comment-count" data-disqus-url="http://127.0.0.1:4000/configuring-ip-address-by-specifying-gateway"></span></a>
</div>

  
      <footer class="site-footer">
        <small>&copy; 2012-2016 by Jekyll Theme</small>
      </footer>
  
    </main>

  </div>
  <div id="backtotop">
    <i class="icon-up-big"></i>
  </div>
  <script type="text/javascript" src="/assets/js/main.js"></script>
  </body>
</html>
