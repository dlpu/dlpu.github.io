<!DOCTYPE html>
<!--[if lte IE 8]><html class="ie lte8"><![endif]-->
<!--[if IE]><html class="ie"><![endif]-->
<!--[if !IE]><!--><html><!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Arch Linux 下的 ADSL 拨号上网 | 殷东亮的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.3, user-scalable=no" />
    <meta name="description" content="前几天拉了网，普通的 ADSL 宽带，由于没有路由器，因此只能通过自身的拨号。在 Arch Linux 下，可以通过自带的 Netcfg 来连接，可以通过 RP-PPPoE 来连接，也可直接配置 pppd 实现拨号。" />
    <meta name="keywords" content="Arch Linux, ADSL, Netcfg, RP-PPPoE, pppd" />
    <meta name="author" content="fooleap" />
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="canonical" href="http://127.0.0.1:4000/using-archlinux-with-adsl" />
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />
    <link rel="icon" href="/favicon.png" />
    <link rel="alternate" type="application/atom+xml" title="殷东亮的博客 Atom Feed" href="http://blog.fooleap.org/atom.xml" />
    <script type="text/javascript" src="/assets/js/modernizr.js"></script>
    <!--[if lte IE 9]>
      <script src="/assets/js/html5shiv.min.js"></script>
      <script src="/assets/js/respond.min.js"></script>
      <script src="/assets/js/classList.min.js"></script>
      <script type="text/javascript">
        document.createElement('main');
      </script>
    <![endif]-->
  </head>
  <body>
  <nav id="navigation">
      <ul class="navigation-list hide">
          <li><a href="/" class="navigation-item"><i class="icon-home"></i>首页</a></li>
          <li><a href="/archive.html" class="navigation-item"><i class="icon-box"></i>归档</a></li>
          <li><a href="/about.html" class="navigation-item"><i class="icon-user"></i>关于</a></li>
      </ul>
      <i id="menu" class="icon icon-menu"></i>
  </nav>
  
  <div class="container">
    <main class="wrapper">
      <header class="site-header">
        <h1>
          Arch Linux 下的 ADSL 拨号上网
        </h1>
        <h2 class="sub-heading">
            <i class="icon-calendar"></i><time datetime="2013-01-02">2013 年 01 月 02 日</time>
        </h2>
      </header>
  <article class="post-content">
    
  <div class="main-content">
<ul id="toc">
  <li><a href="#id-netcfg" id="markdown-toc-id-netcfg">Netcfg</a></li>
  <li><a href="#id-rp-pppoe" id="markdown-toc-id-rp-pppoe">RP-PPPoE</a></li>
  <li><a href="#id-pppd" id="markdown-toc-id-pppd">pppd</a></li>
</ul>

<p>前几天拉了网，普通的 ADSL 宽带，由于没有路由器，因此只能通过自身的拨号。</p>

<p>在 Arch Linux 下，可以通过自带的 Netcfg 来连接，可以通过 RP-PPPoE 来连接，也可直接配置 pppd 实现拨号。</p>

<h2 id="id-netcfg">Netcfg</h2>

<p>这款软件，从它需要安装，到 Arch 自带，功能不断地增强，使用越来越方便，现在已经支持 ADSL 拨号，简单快速。</p>

<p>从实例中复制 pppoe 作为 adsl 拨号的配置</p>

<div class="highlighter-rouge"><pre class="highlight"><code># cp /etc/network.d/examples/pppoe /etc/network.d/fooleap
</code></pre>
</div>

<p>只需修改这两行中的用户名和密码</p>

<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:8px;"><code>/etc/network.d/fooleap</code></pre>
<pre style="margin-top: 0; border-top:.1rem dashed #ccc; padding-top:8px;"><code>USER='example@yourprovider.com'
PASSWORD='very secret'</code></pre>

<p>尝试拨号</p>

<div class="highlighter-rouge"><pre class="highlight"><code># netcfg fooleap
</code></pre>
</div>

<p>添加守护进程实现自动联网</p>

<div class="highlighter-rouge"><pre class="highlight"><code># systemctl enable netcfg@fooleap
</code></pre>
</div>

<h2 id="id-rp-pppoe">RP-PPPoE</h2>

<p>安装 rp-pppoe</p>

<div class="highlighter-rouge"><pre class="highlight"><code># pacman -S rp-pppoe
</code></pre>
</div>

<p>启动配置程序，按提示，一般填上用户名、密码、 DNS 服务器即可</p>

<div class="highlighter-rouge"><pre class="highlight"><code># pppoe-setup
</code></pre>
</div>

<p>拨号</p>

<div class="highlighter-rouge"><pre class="highlight"><code># pppoe-start
</code></pre>
</div>

<p>作为守护进程启动</p>

<div class="highlighter-rouge"><pre class="highlight"><code># systemctl enable adsl
</code></pre>
</div>

<p>注：若在 pppoe-setup 没有设定 DNS 服务器，记得手动搞定 /etc/resolv.conf</p>

<h2 id="id-pppd">pppd</h2>

<p>仔细观察，不难发现，通过 Netcfg 及 RP-PPPoE 拨号后，都是启用了 pppd 进程，所以 Netcfg、RP-PPPoE 只是配角，提供自动化脚本方便使用 pppd，真正的主角是 pppd，手动配置 pppd 理论上更省资源。</p>

<p>在 /etc/ppp/peers 这个目录下创建一个文件，如 fooleap，内容如下，其实一般只需改“帐号”，即宽带帐号</p>

<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:8px;"><code>/etc/ppp/peers/fooleap</code></pre>
<pre style="margin-top: 0; border-top:.1rem dashed #ccc; padding-top:8px;"><code>plugin rp-pppoe.so
# 不需要安装 rp-pppoe 这个包
eth0
name "帐号"
usepeerdns
persist
defaultroute
hide-password
noauth</code></pre>

<p>编辑 /etc/ppp/pap-secrets</p>

<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:8px;"><code>/etc/ppp/pap-secrets</code></pre>
<pre style="margin-top: 0; border-top:.1rem dashed #ccc; padding-top:8px;"><code>"帐号" * "密码"</code></pre>

<p>pap-secrets 文件的权限设为 600</p>

<div class="highlighter-rouge"><pre class="highlight"><code># chmod 600 /etc/ppp/pap-secrets
</code></pre>
</div>

<p>拨号，只需使用 pppd call your_provider，your_provider 即刚创建于 /etc/ppp/peers 下的文件名，此例中是</p>

<div class="highlighter-rouge"><pre class="highlight"><code># pppd call fooleap
</code></pre>
</div>

<p>若没有连上，检查 eth0 端口有没激活</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ifconfig eth0 | grep UP
</code></pre>
</div>

<p>没返回即没被激活，可以使用下面命令激活 eth0 端口</p>

<div class="highlighter-rouge"><pre class="highlight"><code># ifconfig eth0 up
</code></pre>
</div>

<p>连接也可以使用 pon ( 这脚本藏在 /usr/bin/pon )</p>

<div class="highlighter-rouge"><pre class="highlight"><code># pon fooleap
</code></pre>
</div>

<p>断开连接可以使用 poff</p>

<div class="highlighter-rouge"><pre class="highlight"><code># poff fooleap
</code></pre>
</div>

<p>也可以直接 kill 它</p>

<div class="highlighter-rouge"><pre class="highlight"><code># killall pppd
</code></pre>
</div>

<p>做软链接 /etc/ppp/peers/provider，就可以直接通过 pon 这个命令拨号，断开链接也就可以直接使用 poff 啦</p>

<div class="highlighter-rouge"><pre class="highlight"><code># ln -s /etc/ppp/peers/fooleap /etc/ppp/peers/provider
</code></pre>
</div>

<p>设置为守护进程</p>

<p>自动加载 ppp_generic 模块</p>

<div class="highlighter-rouge"><pre class="highlight"><code># echo "ppp_generic" &gt; /etc/modules-load.d/ppp.conf
</code></pre>
</div>

<p>添加守护进程</p>

<div class="highlighter-rouge"><pre class="highlight"><code># systemctl enable ppp@fooleap
</code></pre>
</div>

<p>注：可以用 systemd 将激活端口及拨号作为守护进程，实现自动拨号，参考 <a href="http://www.linuxsir.org/bbs/thread382947.html">systemd 初体验</a></p>

<p>鄙人折腾了许久，还是没成功，不知道是 Arch 和 Gentoo 有区别，还是哪里出现问题，搞定告知哈～</p>

<p><strong>参考资料</strong></p>

<ul>
  <li>pppd: <a href="https://wiki.archlinux.org/index.php/pppd">https://wiki.archlinux.org/index.php/pppd</a></li>
  <li>Direct Modem Connection: <a href="https://wiki.archlinux.org/index.php/Direct_Modem_Connection">https://wiki.archlinux.org/index.php/Direct_Modem_Connection</a></li>
</ul>

<p><strong>本文历史</strong></p>

<ul>
  <li>2013 年 01 月 02 日 完成初稿</li>
</ul>

  </div>

  <div id="posts">
    <div id="random-posts" class="posts">
      <strong>猜你喜欢</strong>
      <ul>
      </ul>
    </div>
  
    <div id="recent-posts" class="posts">
      <strong>最近更新</strong>
      <ul>
      
        <li><a href="/configuring-ip-address-by-specifying-gateway" title="配置特定 IP 地址走指定网关">配置特定 IP 地址走指定网关 </a></li>
      
        <li><a href="/add-google-satellite-layer-in-amap" title="高德地图 API 叠加谷歌地图图层">高德地图 API 叠加谷歌地图图层 </a></li>
      
        <li><a href="/from-codoon-to-nikeplus" title="将咕咚的数据导入到 Nike+">将咕咚的数据导入到 Nike+ </a></li>
      
        <li><a href="/the-influence-of-sports-apps" title="运动 APP 的作用">运动 APP 的作用 </a></li>
      
        <li><a href="/the-last-run-of-june" title="今年 6 月的最后一次跑步">今年 6 月的最后一次跑步 </a></li>
      
      </ul>
    </div>
  </div>

  <div id="info" class="tech">

    <span id="share">
  <div id="qrcode"></div>
  <a id="wechat" title="分享到微信" data-wechat-url="http://127.0.0.1:4000/using-archlinux-with-adsl" href="javascript:void(0);"><i class="icon-wechat"></i></a>
  <a id="weibo" target="_blank" title="分享到微博" href="http://service.weibo.com/share/share.php?title=Arch Linux 下的 ADSL 拨号上网 | 殷东亮的博客 via @&amp;url=http://127.0.0.1:4000/using-archlinux-with-adsl&amp;type=3&amp;searchPic=1"><i class="icon-weibo"></i></a>
  <a id="qzone" target="_blank" title="分享到 QQ 空间" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://127.0.0.1:4000/using-archlinux-with-adsl&amp;title=Arch Linux 下的 ADSL 拨号上网 | 殷东亮的博客&amp;summary=前几天拉了网，普通的 ADSL 宽带，由于没有路由器，因此只能通过自身的拨号。在 Arch Linux 下，可以通过自带的 Netcfg 来连接，可以通过 RP-PPPoE 来连接，也可直接配置 pppd 实现拨号。&amp;site=http://127.0.0.1:4000"><i class="icon-qzone"></i></a>
  <a id="twitter" target="_blank" title="Share to Twitter" href="https://twitter.com/intent/tweet?url=http://127.0.0.1:4000/using-archlinux-with-adsl&amp;text=Arch Linux 下的 ADSL 拨号上网｜殷东亮的博客&amp;via="><i class="icon-twitter"></i></a>
  <a id="facebook" target="_blank" title="Share to Facebook" href="http://www.facebook.com/sharer.php?u=http://127.0.0.1:4000/using-archlinux-with-adsl&amp;t=Arch Linux 下的 ADSL 拨号上网 | 殷东亮的博客"><i class="icon-facebook-official"></i></a>
  <a id="gplus" target="_blank" title="Share to Google+" href="https://plus.google.com/share?url=http://127.0.0.1:4000/using-archlinux-with-adsl"><i class="icon-gplus-squared"></i></a>
</span>


    <span class='like'><a href="javascript:void(0)" title=""><i class="icon-heart-empty"></i> <span class="disqus-like-count"></span></a></span>
    <span class='view-code'><a href="javascript:void(0)" data-md="https://raw.githubusercontent.com/fooleap/fooleap.github.io/master/_posts/2013-01-02-using-archlinux-with-adsl.md" title="在正文中查看源码"><i class="icon-file-code"></i>源码</a></span>
    <span class="number-of-word"><i class="icon-calc"></i>1824 字</span>
    <span class="page-tags"><i class="icon-tags"></i><ul class="tags"> <li class="tag"><a href="/tags.html#Arch Linux" target="_blank" title="查看“Arch Linux”的相关文章">Arch Linux</a></li><li class="tag"><a href="/tags.html#ADSL" target="_blank" title="查看“ADSL”的相关文章">ADSL</a></li><li class="tag"><a href="/tags.html#Netcfg" target="_blank" title="查看“Netcfg”的相关文章">Netcfg</a></li><li class="tag"><a href="/tags.html#RP-PPPoE" target="_blank" title="查看“RP-PPPoE”的相关文章">RP-PPPoE</a></li><li class="tag"><a href="/tags.html#pppd" target="_blank" title="查看“pppd”的相关文章">pppd</a></li></ul></span>
  </div>

</article>

<div class="comment" id="disqus_thread">
    <a class="show-comments" href="http://127.0.0.1:4000/using-archlinux-with-adsl#disqus_thread" data-disqus-identifier="/using-archlinux-with-adsl"><span class="has-comment"><i class="icon-chat-empty"></i> 留下</span>评论 <span class="disqus-comment-count" data-disqus-url="http://127.0.0.1:4000/using-archlinux-with-adsl"></span></a>
</div>

  
      <footer class="site-footer">
        <small>&copy; 2012-2016 by Jekyll Theme</small>
      </footer>
  
    </main>

  </div>
  <div id="backtotop">
    <i class="icon-up-big"></i>
  </div>
  <script type="text/javascript" src="/assets/js/main.js"></script>
  </body>
</html>
